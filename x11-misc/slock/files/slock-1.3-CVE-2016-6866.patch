--- a/slock.c
+++ b/slock.c
@@ -310,6 +310,8 @@
 
 #ifndef HAVE_BSD_AUTH
 	pws = getpw();
+	if(strlen(pws) < 2)
+		die("This user has no password set.\n");
 #endif
 
 	if (!(dpy = XOpenDisplay(0)))
